{"version":3,"file":"wpfeatureloop.umd.js","sources":["../src/wpfeatureloop.js"],"sourcesContent":["/**\n * WPFeatureLoop SDK\n * A feature voting widget for WordPress plugins\n *\n * @version 1.0.0\n * @license MIT\n */\n\n(function(global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.WPFeatureLoop = factory());\n})(this, function() {\n  'use strict';\n\n  /**\n   * SVG Icons\n   */\n  const icons = {\n    plus: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M12 5v14M5 12h14\"/></svg>',\n    arrowUp: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m18 15-6-6-6 6\"/></svg>',\n    arrowDown: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m6 9 6 6 6-6\"/></svg>',\n    comment: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"/></svg>',\n    close: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M18 6 6 18M6 6l12 12\"/></svg>',\n    send: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m22 2-7 20-4-9-9-4 20-7z\"/><path d=\"m22 2-11 11\"/></svg>',\n    empty: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\"/></svg>',\n    error: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"/><path d=\"m15 9-6 6M9 9l6 6\"/></svg>'\n  };\n\n  /**\n   * Translations\n   */\n  const translations = {\n    'en': {\n      title: 'Feature Roadmap',\n      subtitle: 'Vote for features you want to see next',\n      suggestFeature: 'Suggest Feature',\n      suggestTitle: 'Suggest a Feature',\n      titleLabel: 'Title',\n      titlePlaceholder: 'Brief description of your feature idea',\n      descriptionLabel: 'Description',\n      descriptionPlaceholder: 'Explain the feature and why it would be valuable...',\n      categoryLabel: 'Category',\n      categoryPlaceholder: 'e.g., UI/UX, Performance, Integration',\n      cancel: 'Cancel',\n      submit: 'Submit Feature',\n      comments: 'comments',\n      comment: 'comment',\n      addComment: 'Add a comment...',\n      noComments: 'No comments yet. Be the first to share your thoughts!',\n      emptyTitle: 'No features yet',\n      emptyText: 'Be the first to suggest a feature!',\n      errorTitle: 'Failed to load features',\n      errorText: 'Please try again later.',\n      retry: 'Retry',\n      fillAllFields: 'Please fill in all fields',\n      featureSubmitted: 'Feature submitted successfully!',\n      commentAdded: 'Comment added!',\n      voteSaved: 'Vote saved!',\n      statusOpen: 'Open',\n      statusPlanned: 'Planned',\n      statusProgress: 'In Progress',\n      statusCompleted: 'Completed',\n      upvote: 'Upvote',\n      downvote: 'Downvote'\n    },\n    'pt-BR': {\n      title: 'Roadmap de Features',\n      subtitle: 'Vote nas funcionalidades que deseja ver',\n      suggestFeature: 'Sugerir Feature',\n      suggestTitle: 'Sugerir uma Feature',\n      titleLabel: 'Título',\n      titlePlaceholder: 'Breve descrição da sua ideia',\n      descriptionLabel: 'Descrição',\n      descriptionPlaceholder: 'Explique a feature e por que seria valiosa...',\n      categoryLabel: 'Categoria',\n      categoryPlaceholder: 'Ex: UI/UX, Performance, Integração',\n      cancel: 'Cancelar',\n      submit: 'Enviar Feature',\n      comments: 'comentários',\n      comment: 'comentário',\n      addComment: 'Adicionar um comentário...',\n      noComments: 'Nenhum comentário ainda. Seja o primeiro!',\n      emptyTitle: 'Nenhuma feature ainda',\n      emptyText: 'Seja o primeiro a sugerir uma feature!',\n      errorTitle: 'Erro ao carregar features',\n      errorText: 'Por favor, tente novamente mais tarde.',\n      retry: 'Tentar novamente',\n      fillAllFields: 'Por favor, preencha todos os campos',\n      featureSubmitted: 'Feature enviada com sucesso!',\n      commentAdded: 'Comentário adicionado!',\n      voteSaved: 'Voto salvo!',\n      statusOpen: 'Aberto',\n      statusPlanned: 'Planejado',\n      statusProgress: 'Em Progresso',\n      statusCompleted: 'Concluído',\n      upvote: 'Votar a favor',\n      downvote: 'Votar contra'\n    }\n  };\n\n  /**\n   * API Service\n   * Handles all API communication (fake data for now)\n   */\n  class ApiService {\n    constructor(config) {\n      this.publicKey = config.publicKey;\n      this.projectId = config.projectId;\n      this.user = config.user;\n      this.signature = config.signature;\n      this.baseUrl = config.apiUrl || 'https://api.wpfeatureloop.io/v1';\n    }\n\n    /**\n     * Simulate API delay\n     */\n    async _simulateDelay(ms = 800) {\n      return new Promise(resolve => setTimeout(resolve, ms));\n    }\n\n    /**\n     * Get headers for API requests\n     */\n    _getHeaders() {\n      return {\n        'Content-Type': 'application/json',\n        'X-Public-Key': this.publicKey,\n        'X-Project-Id': this.projectId,\n        'X-User-Id': this.user?.id?.toString() || '',\n        'X-Signature': this.signature || ''\n      };\n    }\n\n    /**\n     * Fetch features list\n     * @returns {Promise<Array>}\n     */\n    async getFeatures() {\n      await this._simulateDelay();\n\n      // TODO: Replace with real API call\n      // const response = await fetch(`${this.baseUrl}/features`, {\n      //   method: 'GET',\n      //   headers: this._getHeaders()\n      // });\n      // return response.json();\n\n      // Fake data for now\n      return [\n        {\n          id: 1,\n          title: 'Dark Mode Support',\n          description: 'Add a dark mode theme option that follows system preferences or can be toggled manually. Essential for users who work at night or prefer darker interfaces.',\n          votes: 47,\n          userVote: null,\n          status: 'planned',\n          commentsCount: 2,\n          tags: ['UI/UX'],\n          createdAt: '2024-01-15T10:00:00Z'\n        },\n        {\n          id: 2,\n          title: 'Export Data to CSV',\n          description: 'Allow users to export all their data in CSV format for backup or migration purposes. Include options to select specific date ranges and data types.',\n          votes: 32,\n          userVote: null,\n          status: 'progress',\n          commentsCount: 1,\n          tags: ['Data'],\n          createdAt: '2024-01-10T14:30:00Z'\n        },\n        {\n          id: 3,\n          title: 'API Webhooks',\n          description: 'Implement webhooks to notify external services when certain events occur, like new submissions or status changes.',\n          votes: 28,\n          userVote: 'up',\n          status: 'open',\n          commentsCount: 5,\n          tags: ['Integration'],\n          createdAt: '2024-01-08T09:15:00Z'\n        },\n        {\n          id: 4,\n          title: 'Multi-language Support',\n          description: 'Add support for multiple languages to make the plugin accessible to users worldwide.',\n          votes: 15,\n          userVote: null,\n          status: 'open',\n          commentsCount: 0,\n          tags: ['i18n'],\n          createdAt: '2024-01-05T16:45:00Z'\n        }\n      ];\n    }\n\n    /**\n     * Vote on a feature\n     * @param {number} featureId\n     * @param {string} voteType - 'up', 'down', or 'none'\n     * @returns {Promise<Object>}\n     */\n    async vote(featureId, voteType) {\n      await this._simulateDelay(300);\n\n      // TODO: Replace with real API call\n      // const response = await fetch(`${this.baseUrl}/features/${featureId}/vote`, {\n      //   method: 'POST',\n      //   headers: this._getHeaders(),\n      //   body: JSON.stringify({ vote: voteType })\n      // });\n      // return response.json();\n\n      return { success: true, featureId, voteType };\n    }\n\n    /**\n     * Get comments for a feature\n     * @param {number} featureId\n     * @returns {Promise<Array>}\n     */\n    async getComments(featureId) {\n      await this._simulateDelay(500);\n\n      // TODO: Replace with real API call\n      // const response = await fetch(`${this.baseUrl}/features/${featureId}/comments`, {\n      //   method: 'GET',\n      //   headers: this._getHeaders()\n      // });\n      // return response.json();\n\n      // Fake data based on feature\n      const commentsMap = {\n        1: [\n          { id: 1, author: 'Sarah M.', initials: 'SM', text: 'This would be amazing! My eyes would thank you.', time: '2 days ago' },\n          { id: 2, author: 'Dev Team', initials: 'DT', text: \"We're planning this for the next major release!\", time: '1 day ago' }\n        ],\n        2: [\n          { id: 1, author: 'Mike R.', initials: 'MR', text: 'Need this for compliance reporting!', time: '5 days ago' }\n        ],\n        3: [\n          { id: 1, author: 'John D.', initials: 'JD', text: 'Would love to integrate with Zapier!', time: '1 week ago' },\n          { id: 2, author: 'Anna K.', initials: 'AK', text: 'Slack integration would be great too.', time: '6 days ago' },\n          { id: 3, author: 'Dev Team', initials: 'DT', text: 'Great suggestions! Adding to our roadmap.', time: '5 days ago' },\n          { id: 4, author: 'Peter S.', initials: 'PS', text: 'Any ETA on this?', time: '3 days ago' },\n          { id: 5, author: 'Dev Team', initials: 'DT', text: 'Targeting Q2 2024!', time: '2 days ago' }\n        ]\n      };\n\n      return commentsMap[featureId] || [];\n    }\n\n    /**\n     * Add a comment to a feature\n     * @param {number} featureId\n     * @param {string} text\n     * @returns {Promise<Object>}\n     */\n    async addComment(featureId, text) {\n      await this._simulateDelay(400);\n\n      // TODO: Replace with real API call\n      // const response = await fetch(`${this.baseUrl}/features/${featureId}/comments`, {\n      //   method: 'POST',\n      //   headers: this._getHeaders(),\n      //   body: JSON.stringify({ text })\n      // });\n      // return response.json();\n\n      const userName = this.user?.name || 'You';\n      const initials = userName.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);\n\n      return {\n        id: Date.now(),\n        author: userName,\n        initials,\n        text,\n        time: 'Just now'\n      };\n    }\n\n    /**\n     * Create a new feature suggestion\n     * @param {Object} feature\n     * @returns {Promise<Object>}\n     */\n    async createFeature(feature) {\n      await this._simulateDelay(600);\n\n      // TODO: Replace with real API call\n      // const response = await fetch(`${this.baseUrl}/features`, {\n      //   method: 'POST',\n      //   headers: this._getHeaders(),\n      //   body: JSON.stringify(feature)\n      // });\n      // return response.json();\n\n      return {\n        id: Date.now(),\n        title: feature.title,\n        description: feature.description,\n        votes: 1,\n        userVote: 'up',\n        status: 'open',\n        commentsCount: 0,\n        tags: [feature.category || 'General'],\n        createdAt: new Date().toISOString()\n      };\n    }\n  }\n\n  /**\n   * WPFeatureLoop Main Class\n   */\n  class WPFeatureLoop {\n    /**\n     * @param {Object} config\n     * @param {string} config.container - CSS selector for the container element\n     * @param {string} config.publicKey - Public API key\n     * @param {string} config.projectId - Project ID\n     * @param {string} [config.locale='en'] - Locale for translations\n     * @param {Object} [config.user] - User data\n     * @param {number|string} config.user.id - User ID (required)\n     * @param {string} [config.user.email] - User email\n     * @param {string} [config.user.name] - User display name\n     * @param {string} [config.user.plan] - User plan (free, pro, etc)\n     * @param {Object} [config.user.meta] - Additional user metadata\n     * @param {string} [config.signature] - HMAC signature for user data\n     * @param {Array<string>} [config.allowedRoles] - Roles allowed to create features\n     * @param {string} [config.userRole] - Current user's role\n     * @param {string} [config.apiUrl] - Custom API URL\n     */\n    constructor(config) {\n      this.config = config;\n      this.container = null;\n      this.features = [];\n      this.isLoading = true;\n      this.hasError = false;\n      this.currentCommentFeatureId = null;\n      this.currentComments = [];\n\n      // Validate required config\n      if (!config.container) {\n        throw new Error('WPFeatureLoop: container is required');\n      }\n      if (!config.publicKey) {\n        throw new Error('WPFeatureLoop: publicKey is required');\n      }\n      if (!config.projectId) {\n        throw new Error('WPFeatureLoop: projectId is required');\n      }\n      if (!config.user?.id) {\n        throw new Error('WPFeatureLoop: user.id is required');\n      }\n\n      // Set defaults\n      this.locale = config.locale || 'en';\n      this.t = translations[this.locale] || translations['en'];\n      this.allowedRoles = config.allowedRoles || ['administrator'];\n      this.userRole = config.userRole || 'subscriber';\n\n      // Initialize API service\n      this.api = new ApiService(config);\n    }\n\n    /**\n     * Check if current user can create features\n     */\n    canCreateFeature() {\n      return this.allowedRoles.includes(this.userRole);\n    }\n\n    /**\n     * Initialize the widget\n     */\n    async init() {\n      this.container = document.querySelector(this.config.container);\n\n      if (!this.container) {\n        throw new Error(`WPFeatureLoop: Container \"${this.config.container}\" not found`);\n      }\n\n      this.container.classList.add('wfl-container');\n      this.renderSkeleton();\n\n      try {\n        this.features = await this.api.getFeatures();\n        this.isLoading = false;\n        this.render();\n      } catch (error) {\n        console.error('WPFeatureLoop: Failed to load features', error);\n        this.isLoading = false;\n        this.hasError = true;\n        this.renderError();\n      }\n    }\n\n    /**\n     * Render skeleton loading state\n     */\n    renderSkeleton() {\n      const skeletonCards = Array(3).fill(0).map(() => `\n        <div class=\"wfl-skeleton-card\">\n          <div class=\"wfl-skeleton-vote\">\n            <div class=\"wfl-skeleton wfl-skeleton-vote-btn\"></div>\n            <div class=\"wfl-skeleton wfl-skeleton-vote-count\"></div>\n            <div class=\"wfl-skeleton wfl-skeleton-vote-btn\"></div>\n          </div>\n          <div class=\"wfl-skeleton-content\">\n            <div class=\"wfl-skeleton wfl-skeleton-title\"></div>\n            <div class=\"wfl-skeleton wfl-skeleton-desc\"></div>\n            <div class=\"wfl-skeleton wfl-skeleton-desc-2\"></div>\n            <div class=\"wfl-skeleton-footer\">\n              <div class=\"wfl-skeleton wfl-skeleton-meta\"></div>\n              <div class=\"wfl-skeleton wfl-skeleton-tag\"></div>\n            </div>\n          </div>\n        </div>\n      `).join('');\n\n      this.container.innerHTML = `\n        <div class=\"wfl-header\">\n          <div class=\"wfl-header-content\">\n            <h1 class=\"wfl-title\">${this.t.title}</h1>\n            <p class=\"wfl-subtitle\">${this.t.subtitle}</p>\n          </div>\n          ${this.canCreateFeature() ? `\n            <button class=\"wfl-btn wfl-btn-primary wfl-ripple\" disabled>\n              ${icons.plus}\n              ${this.t.suggestFeature}\n            </button>\n          ` : ''}\n        </div>\n        <div class=\"wfl-list\">\n          ${skeletonCards}\n        </div>\n      `;\n    }\n\n    /**\n     * Render error state\n     */\n    renderError() {\n      this.container.innerHTML = `\n        <div class=\"wfl-header\">\n          <div class=\"wfl-header-content\">\n            <h1 class=\"wfl-title\">${this.t.title}</h1>\n            <p class=\"wfl-subtitle\">${this.t.subtitle}</p>\n          </div>\n        </div>\n        <div class=\"wfl-error\">\n          <div class=\"wfl-error-icon\">${icons.error}</div>\n          <h3 class=\"wfl-error-title\">${this.t.errorTitle}</h3>\n          <p class=\"wfl-error-text\">${this.t.errorText}</p>\n          <button class=\"wfl-btn wfl-btn-primary\" id=\"wfl-retry\">\n            ${this.t.retry}\n          </button>\n        </div>\n      `;\n\n      this.container.querySelector('#wfl-retry')?.addEventListener('click', () => {\n        this.hasError = false;\n        this.isLoading = true;\n        this.init();\n      });\n    }\n\n    /**\n     * Main render method\n     */\n    render() {\n      const featuresHtml = this.features.length > 0\n        ? this.features.map(f => this.renderCard(f)).join('')\n        : this.renderEmpty();\n\n      this.container.innerHTML = `\n        <div class=\"wfl-header\">\n          <div class=\"wfl-header-content\">\n            <h1 class=\"wfl-title\">${this.t.title}</h1>\n            <p class=\"wfl-subtitle\">${this.t.subtitle}</p>\n          </div>\n          ${this.canCreateFeature() ? `\n            <button class=\"wfl-btn wfl-btn-primary wfl-ripple\" id=\"wfl-add-feature\">\n              ${icons.plus}\n              ${this.t.suggestFeature}\n            </button>\n          ` : ''}\n        </div>\n        <div class=\"wfl-list\" id=\"wfl-list\">\n          ${featuresHtml}\n        </div>\n        ${this.renderModal()}\n        ${this.renderCommentModal()}\n        <div class=\"wfl-toast\" id=\"wfl-toast\"></div>\n      `;\n\n      this.attachEventListeners();\n    }\n\n    /**\n     * Render a feature card\n     */\n    renderCard(feature) {\n      const voteClass = feature.votes > 0 ? 'wfl-vote-positive' : (feature.votes < 0 ? 'wfl-vote-negative' : '');\n      const upVoted = feature.userVote === 'up';\n      const downVoted = feature.userVote === 'down';\n      const commentText = feature.commentsCount === 1 ? this.t.comment : this.t.comments;\n\n      return `\n        <div class=\"wfl-card\" data-id=\"${feature.id}\">\n          <div class=\"wfl-vote\">\n            <button class=\"wfl-vote-btn wfl-vote-up wfl-tooltip ${upVoted ? 'wfl-voted' : ''}\"\n                    data-id=\"${feature.id}\"\n                    data-action=\"up\"\n                    data-tooltip=\"${this.t.upvote}\">\n              ${icons.arrowUp}\n            </button>\n            <span class=\"wfl-vote-count ${voteClass}\" data-id=\"${feature.id}\">${feature.votes}</span>\n            <button class=\"wfl-vote-btn wfl-vote-down wfl-tooltip ${downVoted ? 'wfl-voted' : ''}\"\n                    data-id=\"${feature.id}\"\n                    data-action=\"down\"\n                    data-tooltip=\"${this.t.downvote}\">\n              ${icons.arrowDown}\n            </button>\n          </div>\n          <div class=\"wfl-content\">\n            <div class=\"wfl-content-header\">\n              <h3 class=\"wfl-feature-title\" data-id=\"${feature.id}\">${feature.title}</h3>\n              ${this.renderStatus(feature.status)}\n            </div>\n            <p class=\"wfl-description\">${feature.description}</p>\n            <div class=\"wfl-footer\">\n              <button class=\"wfl-meta wfl-comment-trigger\" data-id=\"${feature.id}\">\n                ${icons.comment}\n                <span>${feature.commentsCount} ${commentText}</span>\n              </button>\n              ${feature.tags.map(tag => `<span class=\"wfl-tag\">${tag}</span>`).join('')}\n            </div>\n          </div>\n        </div>\n      `;\n    }\n\n    /**\n     * Render status badge\n     */\n    renderStatus(status) {\n      const labels = {\n        open: this.t.statusOpen,\n        planned: this.t.statusPlanned,\n        progress: this.t.statusProgress,\n        completed: this.t.statusCompleted\n      };\n\n      return `\n        <span class=\"wfl-status wfl-status-${status}\">\n          <span class=\"wfl-status-dot\"></span>\n          ${labels[status] || status}\n        </span>\n      `;\n    }\n\n    /**\n     * Render empty state\n     */\n    renderEmpty() {\n      return `\n        <div class=\"wfl-empty\">\n          <div class=\"wfl-empty-icon\">${icons.empty}</div>\n          <h3 class=\"wfl-empty-title\">${this.t.emptyTitle}</h3>\n          <p class=\"wfl-empty-text\">${this.t.emptyText}</p>\n        </div>\n      `;\n    }\n\n    /**\n     * Render feature creation modal\n     */\n    renderModal() {\n      if (!this.canCreateFeature()) return '';\n\n      return `\n        <div class=\"wfl-modal-overlay\" id=\"wfl-modal\">\n          <div class=\"wfl-modal\">\n            <div class=\"wfl-modal-header\">\n              <h2 class=\"wfl-modal-title\">${this.t.suggestTitle}</h2>\n              <button class=\"wfl-modal-close\" id=\"wfl-modal-close\">\n                ${icons.close}\n              </button>\n            </div>\n            <div class=\"wfl-modal-body\">\n              <div class=\"wfl-form-group\">\n                <label class=\"wfl-label\" for=\"wfl-feature-title\">${this.t.titleLabel}</label>\n                <input type=\"text\" class=\"wfl-input\" id=\"wfl-feature-title\" placeholder=\"${this.t.titlePlaceholder}\">\n              </div>\n              <div class=\"wfl-form-group\">\n                <label class=\"wfl-label\" for=\"wfl-feature-desc\">${this.t.descriptionLabel}</label>\n                <textarea class=\"wfl-textarea\" id=\"wfl-feature-desc\" placeholder=\"${this.t.descriptionPlaceholder}\"></textarea>\n              </div>\n              <div class=\"wfl-form-group\">\n                <label class=\"wfl-label\" for=\"wfl-feature-tag\">${this.t.categoryLabel}</label>\n                <input type=\"text\" class=\"wfl-input\" id=\"wfl-feature-tag\" placeholder=\"${this.t.categoryPlaceholder}\">\n              </div>\n            </div>\n            <div class=\"wfl-modal-footer\">\n              <button class=\"wfl-btn wfl-btn-secondary\" id=\"wfl-modal-cancel\">${this.t.cancel}</button>\n              <button class=\"wfl-btn wfl-btn-primary wfl-ripple\" id=\"wfl-modal-submit\">${this.t.submit}</button>\n            </div>\n          </div>\n        </div>\n      `;\n    }\n\n    /**\n     * Render comments modal\n     */\n    renderCommentModal() {\n      return `\n        <div class=\"wfl-modal-overlay\" id=\"wfl-comment-modal\">\n          <div class=\"wfl-modal\">\n            <div class=\"wfl-modal-header\">\n              <h2 class=\"wfl-modal-title\" id=\"wfl-comment-title\">${this.t.comments}</h2>\n              <button class=\"wfl-modal-close\" id=\"wfl-comment-modal-close\">\n                ${icons.close}\n              </button>\n            </div>\n            <div class=\"wfl-modal-body\">\n              <div class=\"wfl-comments-list\" id=\"wfl-comments-list\"></div>\n              <div class=\"wfl-comment-input-wrapper\">\n                <input type=\"text\" class=\"wfl-comment-input\" id=\"wfl-comment-input\" placeholder=\"${this.t.addComment}\">\n                <button class=\"wfl-comment-submit\" id=\"wfl-comment-submit\">\n                  ${icons.send}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      `;\n    }\n\n    /**\n     * Render comments list\n     */\n    renderCommentsList(comments) {\n      if (comments.length === 0) {\n        return `<p style=\"text-align: center; color: var(--wfl-gray-500); padding: 20px;\">${this.t.noComments}</p>`;\n      }\n\n      return comments.map(c => `\n        <div class=\"wfl-comment\">\n          <div class=\"wfl-comment-avatar\">${c.initials}</div>\n          <div class=\"wfl-comment-content\">\n            <div class=\"wfl-comment-header\">\n              <span class=\"wfl-comment-author\">${c.author}</span>\n              <span class=\"wfl-comment-time\">${c.time}</span>\n            </div>\n            <p class=\"wfl-comment-text\">${c.text}</p>\n          </div>\n        </div>\n      `).join('');\n    }\n\n    /**\n     * Attach event listeners\n     */\n    attachEventListeners() {\n      // Add feature button\n      const addBtn = this.container.querySelector('#wfl-add-feature');\n      if (addBtn) {\n        addBtn.addEventListener('click', () => this.openModal());\n      }\n\n      // Modal events\n      const modal = this.container.querySelector('#wfl-modal');\n      if (modal) {\n        const modalClose = this.container.querySelector('#wfl-modal-close');\n        const modalCancel = this.container.querySelector('#wfl-modal-cancel');\n        const modalSubmit = this.container.querySelector('#wfl-modal-submit');\n\n        modalClose?.addEventListener('click', () => this.closeModal());\n        modalCancel?.addEventListener('click', () => this.closeModal());\n        modal.addEventListener('click', (e) => {\n          if (e.target === modal) this.closeModal();\n        });\n        modalSubmit?.addEventListener('click', () => this.handleSubmitFeature());\n      }\n\n      // Comment modal events\n      const commentModal = this.container.querySelector('#wfl-comment-modal');\n      if (commentModal) {\n        const commentClose = this.container.querySelector('#wfl-comment-modal-close');\n\n        commentClose?.addEventListener('click', () => this.closeCommentModal());\n        commentModal.addEventListener('click', (e) => {\n          if (e.target === commentModal) this.closeCommentModal();\n        });\n      }\n\n      // Card events\n      this.features.forEach(f => this.attachCardListeners(f.id));\n    }\n\n    /**\n     * Attach listeners to a specific card\n     */\n    attachCardListeners(featureId) {\n      const card = this.container.querySelector(`.wfl-card[data-id=\"${featureId}\"]`);\n      if (!card) return;\n\n      // Vote buttons\n      card.querySelectorAll('.wfl-vote-btn').forEach(btn => {\n        btn.addEventListener('click', (e) => {\n          e.stopPropagation();\n          this.handleVote(btn);\n        });\n      });\n\n      // Comment trigger\n      const commentTrigger = card.querySelector('.wfl-comment-trigger');\n      if (commentTrigger) {\n        commentTrigger.addEventListener('click', () => {\n          this.openCommentModal(featureId);\n        });\n      }\n    }\n\n    /**\n     * Open feature creation modal\n     */\n    openModal() {\n      const modal = this.container.querySelector('#wfl-modal');\n      if (modal) {\n        modal.classList.add('wfl-active');\n      }\n    }\n\n    /**\n     * Close feature creation modal\n     */\n    closeModal() {\n      const modal = this.container.querySelector('#wfl-modal');\n      if (modal) {\n        modal.classList.remove('wfl-active');\n        this.container.querySelector('#wfl-feature-title').value = '';\n        this.container.querySelector('#wfl-feature-desc').value = '';\n        this.container.querySelector('#wfl-feature-tag').value = '';\n      }\n    }\n\n    /**\n     * Handle feature submission\n     */\n    async handleSubmitFeature() {\n      const title = this.container.querySelector('#wfl-feature-title').value.trim();\n      const description = this.container.querySelector('#wfl-feature-desc').value.trim();\n      const category = this.container.querySelector('#wfl-feature-tag').value.trim() || 'General';\n\n      if (!title || !description) {\n        this.showToast(this.t.fillAllFields, 'error');\n        return;\n      }\n\n      const submitBtn = this.container.querySelector('#wfl-modal-submit');\n      submitBtn.disabled = true;\n\n      try {\n        const newFeature = await this.api.createFeature({ title, description, category });\n        this.features.unshift(newFeature);\n\n        const list = this.container.querySelector('#wfl-list');\n        list.insertAdjacentHTML('afterbegin', this.renderCard(newFeature));\n        this.attachCardListeners(newFeature.id);\n\n        this.closeModal();\n        this.showToast(this.t.featureSubmitted, 'success');\n      } catch (error) {\n        console.error('WPFeatureLoop: Failed to create feature', error);\n        this.showToast(this.t.errorText, 'error');\n      } finally {\n        submitBtn.disabled = false;\n      }\n    }\n\n    /**\n     * Open comments modal\n     */\n    async openCommentModal(featureId) {\n      const feature = this.features.find(f => f.id === featureId);\n      if (!feature) return;\n\n      this.currentCommentFeatureId = featureId;\n      const commentModal = this.container.querySelector('#wfl-comment-modal');\n      const commentsList = this.container.querySelector('#wfl-comments-list');\n      const commentTitle = this.container.querySelector('#wfl-comment-title');\n      const commentInput = this.container.querySelector('#wfl-comment-input');\n\n      // Clear input and show modal\n      commentInput.value = '';\n      commentTitle.textContent = feature.title;\n      commentsList.innerHTML = '<div class=\"wfl-skeleton\" style=\"height: 60px; margin-bottom: 12px;\"></div>'.repeat(2);\n      commentModal.classList.add('wfl-active');\n\n      try {\n        this.currentComments = await this.api.getComments(featureId);\n        commentsList.innerHTML = this.renderCommentsList(this.currentComments);\n\n        // Create submit handler that reads input value at call time\n        const self = this;\n        const handleSubmit = async () => {\n          // Get fresh reference to input element\n          const input = self.container.querySelector('#wfl-comment-input');\n          const submitBtn = self.container.querySelector('#wfl-comment-submit');\n          const text = input.value.trim();\n\n          if (!text) return;\n\n          submitBtn.disabled = true;\n\n          try {\n            const newComment = await self.api.addComment(featureId, text);\n            self.currentComments.push(newComment);\n            commentsList.innerHTML = self.renderCommentsList(self.currentComments);\n\n            // Update comment count on card\n            feature.commentsCount = self.currentComments.length;\n            const card = self.container.querySelector(`.wfl-card[data-id=\"${featureId}\"]`);\n            const commentTrigger = card?.querySelector('.wfl-comment-trigger span');\n            if (commentTrigger) {\n              const commentText = feature.commentsCount === 1 ? self.t.comment : self.t.comments;\n              commentTrigger.textContent = `${feature.commentsCount} ${commentText}`;\n            }\n\n            input.value = '';\n            self.showToast(self.t.commentAdded, 'success');\n          } catch (error) {\n            console.error('WPFeatureLoop: Failed to add comment', error);\n            self.showToast(self.t.errorText, 'error');\n          } finally {\n            submitBtn.disabled = false;\n          }\n        };\n\n        // Attach listeners (replace elements to remove old listeners)\n        const oldSubmit = this.container.querySelector('#wfl-comment-submit');\n        const oldInput = this.container.querySelector('#wfl-comment-input');\n\n        const newSubmit = oldSubmit.cloneNode(true);\n        oldSubmit.parentNode.replaceChild(newSubmit, oldSubmit);\n        newSubmit.addEventListener('click', handleSubmit);\n\n        const newInput = oldInput.cloneNode(true);\n        oldInput.parentNode.replaceChild(newInput, oldInput);\n        newInput.addEventListener('keypress', (e) => {\n          if (e.key === 'Enter') handleSubmit();\n        });\n\n      } catch (error) {\n        console.error('WPFeatureLoop: Failed to load comments', error);\n        commentsList.innerHTML = `<p style=\"text-align: center; color: var(--wfl-danger);\">${this.t.errorText}</p>`;\n      }\n    }\n\n    /**\n     * Close comments modal\n     */\n    closeCommentModal() {\n      const commentModal = this.container.querySelector('#wfl-comment-modal');\n      if (commentModal) {\n        commentModal.classList.remove('wfl-active');\n\n        // Clear input\n        const commentInput = this.container.querySelector('#wfl-comment-input');\n        if (commentInput) {\n          commentInput.value = '';\n        }\n\n        this.currentCommentFeatureId = null;\n        this.currentComments = [];\n      }\n    }\n\n    /**\n     * Handle vote\n     */\n    async handleVote(btn) {\n      const id = parseInt(btn.dataset.id);\n      const action = btn.dataset.action;\n      const feature = this.features.find(f => f.id === id);\n\n      if (!feature) return;\n\n      const card = this.container.querySelector(`.wfl-card[data-id=\"${id}\"]`);\n      const voteCount = card.querySelector('.wfl-vote-count');\n      const upBtn = card.querySelector('.wfl-vote-up');\n      const downBtn = card.querySelector('.wfl-vote-down');\n\n      // Disable buttons during request\n      upBtn.disabled = true;\n      downBtn.disabled = true;\n\n      // Calculate new vote state\n      let newVoteType = 'none';\n      let voteDelta = 0;\n\n      if (action === 'up') {\n        if (feature.userVote === 'up') {\n          voteDelta = -1;\n          newVoteType = 'none';\n        } else if (feature.userVote === 'down') {\n          voteDelta = 2;\n          newVoteType = 'up';\n        } else {\n          voteDelta = 1;\n          newVoteType = 'up';\n        }\n      } else {\n        if (feature.userVote === 'down') {\n          voteDelta = 1;\n          newVoteType = 'none';\n        } else if (feature.userVote === 'up') {\n          voteDelta = -2;\n          newVoteType = 'down';\n        } else {\n          voteDelta = -1;\n          newVoteType = 'down';\n        }\n      }\n\n      // Optimistic update\n      feature.votes += voteDelta;\n      feature.userVote = newVoteType === 'none' ? null : newVoteType;\n\n      // Update UI\n      upBtn.classList.toggle('wfl-voted', feature.userVote === 'up');\n      downBtn.classList.toggle('wfl-voted', feature.userVote === 'down');\n      voteCount.textContent = feature.votes;\n      voteCount.classList.remove('wfl-vote-positive', 'wfl-vote-negative');\n      if (feature.votes > 0) {\n        voteCount.classList.add('wfl-vote-positive');\n      } else if (feature.votes < 0) {\n        voteCount.classList.add('wfl-vote-negative');\n      }\n\n      // Animation\n      voteCount.classList.add('wfl-animating');\n      setTimeout(() => voteCount.classList.remove('wfl-animating'), 300);\n\n      // Confetti on upvote\n      if (action === 'up' && newVoteType === 'up') {\n        this.createConfetti(upBtn);\n      }\n\n      try {\n        await this.api.vote(id, newVoteType);\n      } catch (error) {\n        console.error('WPFeatureLoop: Failed to save vote', error);\n        // Revert on error\n        feature.votes -= voteDelta;\n        feature.userVote = action === 'up'\n          ? (voteDelta === -1 ? 'up' : (voteDelta === 2 ? 'down' : null))\n          : (voteDelta === 1 ? 'down' : (voteDelta === -2 ? 'up' : null));\n\n        upBtn.classList.toggle('wfl-voted', feature.userVote === 'up');\n        downBtn.classList.toggle('wfl-voted', feature.userVote === 'down');\n        voteCount.textContent = feature.votes;\n\n        this.showToast(this.t.errorText, 'error');\n      } finally {\n        upBtn.disabled = false;\n        downBtn.disabled = false;\n      }\n    }\n\n    /**\n     * Create confetti animation\n     */\n    createConfetti(element) {\n      const colors = ['#6366f1', '#8b5cf6', '#ec4899', '#10b981', '#f59e0b'];\n      const rect = element.getBoundingClientRect();\n\n      for (let i = 0; i < 6; i++) {\n        const confetti = document.createElement('div');\n        confetti.className = 'wfl-confetti';\n        confetti.style.left = `${rect.left + rect.width / 2 + (Math.random() - 0.5) * 30}px`;\n        confetti.style.top = `${rect.top + rect.height / 2}px`;\n        confetti.style.background = colors[Math.floor(Math.random() * colors.length)];\n        confetti.style.position = 'fixed';\n        document.body.appendChild(confetti);\n\n        setTimeout(() => confetti.remove(), 600);\n      }\n    }\n\n    /**\n     * Show toast notification\n     */\n    showToast(message, type = 'default') {\n      const toast = this.container.querySelector('#wfl-toast');\n      if (!toast) return;\n\n      toast.textContent = message;\n      toast.className = 'wfl-toast wfl-active';\n\n      if (type === 'success') {\n        toast.classList.add('wfl-toast-success');\n      } else if (type === 'error') {\n        toast.classList.add('wfl-toast-error');\n      }\n\n      setTimeout(() => {\n        toast.classList.remove('wfl-active');\n      }, 3000);\n    }\n\n    /**\n     * Get all features\n     */\n    getFeatures() {\n      return [...this.features];\n    }\n\n    /**\n     * Refresh features from API\n     */\n    async refresh() {\n      this.isLoading = true;\n      this.renderSkeleton();\n\n      try {\n        this.features = await this.api.getFeatures();\n        this.isLoading = false;\n        this.hasError = false;\n        this.render();\n      } catch (error) {\n        console.error('WPFeatureLoop: Failed to refresh features', error);\n        this.isLoading = false;\n        this.hasError = true;\n        this.renderError();\n      }\n    }\n\n    /**\n     * Destroy the widget\n     */\n    destroy() {\n      if (this.container) {\n        this.container.innerHTML = '';\n        this.container.classList.remove('wfl-container');\n      }\n    }\n  }\n\n  /**\n   * Static init method for convenience\n   */\n  WPFeatureLoop.init = function(config) {\n    const instance = new WPFeatureLoop(config);\n    instance.init();\n    return instance;\n  };\n\n  /**\n   * Version\n   */\n  WPFeatureLoop.version = '1.0.0';\n\n  return WPFeatureLoop;\n});\n"],"names":["global","factory","this","icons","translations","ApiService","config","ms","resolve","_b","_a","featureId","voteType","text","userName","initials","n","feature","WPFeatureLoop","error","skeletonCards","featuresHtml","f","voteClass","upVoted","downVoted","commentText","tag","status","labels","comments","c","addBtn","modal","modalClose","modalCancel","modalSubmit","e","commentModal","commentClose","card","btn","commentTrigger","title","description","category","submitBtn","newFeature","commentsList","commentTitle","commentInput","self","handleSubmit","input","newComment","oldSubmit","oldInput","newSubmit","newInput","id","action","voteCount","upBtn","downBtn","newVoteType","voteDelta","element","colors","rect","i","confetti","message","type","toast","instance"],"mappings":"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"}