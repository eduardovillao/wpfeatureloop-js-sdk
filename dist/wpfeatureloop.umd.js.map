{"version":3,"file":"wpfeatureloop.umd.js","sources":["../src/wpfeatureloop.js"],"sourcesContent":["/**\n * WPFeatureLoop SDK\n * A feature voting widget for WordPress plugins\n *\n * @version 1.1.0\n * @license MIT\n */\n\n(function (global, factory) {\n  typeof exports === \"object\" && typeof module !== \"undefined\"\n    ? (module.exports = factory())\n    : typeof define === \"function\" && define.amd\n      ? define(factory)\n      : ((global =\n          typeof globalThis !== \"undefined\" ? globalThis : global || self),\n        (global.WPFeatureLoop = factory()));\n})(this, function () {\n  \"use strict\";\n\n  /**\n   * Embedded Styles\n   */\n  const styles = `:root{--wfl-primary:#6366f1;--wfl-primary-hover:#4f46e5;--wfl-primary-light:#eef2ff;--wfl-success:#10b981;--wfl-warning:#f59e0b;--wfl-danger:#ef4444;--wfl-gray-50:#f9fafb;--wfl-gray-100:#f3f4f6;--wfl-gray-200:#e5e7eb;--wfl-gray-300:#d1d5db;--wfl-gray-400:#9ca3af;--wfl-gray-500:#6b7280;--wfl-gray-600:#4b5563;--wfl-gray-700:#374151;--wfl-gray-800:#1f2937;--wfl-gray-900:#111827;--wfl-shadow-sm:0 1px 2px 0 rgb(0 0 0 / 0.05);--wfl-shadow:0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);--wfl-shadow-md:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--wfl-shadow-lg:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--wfl-shadow-xl:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--wfl-radius:12px;--wfl-radius-lg:16px;--wfl-transition:all 0.2s cubic-bezier(0.4, 0, 0.2, 1)}.wfl-container *{box-sizing:border-box;margin:0;padding:0}.wfl-container{font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Arial,sans-serif;max-width:720px;margin:0 auto;color:var(--wfl-gray-800);line-height:1.5}.wfl-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:32px;flex-wrap:wrap;gap:16px}.wfl-header-content{display:flex;flex-direction:column;gap:4px}.wfl-title{font-size:24px;font-weight:700;color:var(--wfl-gray-900);display:flex;align-items:center;gap:10px}.wfl-title-icon{width:32px;height:32px;background:linear-gradient(135deg,var(--wfl-primary) 0%,#8b5cf6 100%);border-radius:8px;display:flex;align-items:center;justify-content:center}.wfl-title-icon svg{width:18px;height:18px;color:white}.wfl-subtitle{font-size:14px;color:var(--wfl-gray-500)}.wfl-btn{display:inline-flex;align-items:center;gap:8px;padding:10px 18px;font-size:14px;font-weight:600;border-radius:10px;border:none;cursor:pointer;transition:var(--wfl-transition);position:relative;overflow:hidden}.wfl-btn::before{content:\"\";position:absolute;inset:0;background:linear-gradient(135deg,transparent 0%,rgba(255,255,255,0.1) 100%);opacity:0;transition:var(--wfl-transition)}.wfl-btn:hover::before{opacity:1}.wfl-btn-primary{background:linear-gradient(135deg,var(--wfl-primary) 0%,#8b5cf6 100%);color:white;box-shadow:0 4px 14px 0 rgba(99,102,241,0.35)}.wfl-btn-primary:hover{transform:translateY(-2px);box-shadow:0 6px 20px 0 rgba(99,102,241,0.45)}.wfl-btn-primary:active{transform:translateY(0)}.wfl-btn-secondary{background:white;color:var(--wfl-gray-700);border:1px solid var(--wfl-gray-200)}.wfl-btn-secondary:hover{background:var(--wfl-gray-50);border-color:var(--wfl-gray-300)}.wfl-btn svg{width:16px;height:16px}.wfl-btn:disabled{opacity:0.6;cursor:not-allowed;transform:none !important}.wfl-list{display:flex;flex-direction:column;gap:16px}.wfl-card{background:white;border-radius:var(--wfl-radius-lg);border:1px solid var(--wfl-gray-200);padding:16px;display:flex;gap:16px;transition:var(--wfl-transition);position:relative;overflow:hidden;align-items:center}.wfl-card::before{content:\"\";position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--wfl-primary),#8b5cf6,#ec4899);opacity:0;transition:var(--wfl-transition)}.wfl-card:hover{border-color:var(--wfl-gray-300);box-shadow:var(--wfl-shadow-md)}.wfl-card:hover::before{opacity:1}.wfl-vote{display:flex;flex-direction:column;align-items:center;gap:4px;min-width:56px}.wfl-vote-btn{width:40px;height:32px;border-radius:8px;border:1.5px solid var(--wfl-gray-200);background:white;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:var(--wfl-transition);color:var(--wfl-gray-400)}.wfl-vote-btn svg{width:16px;height:16px;transition:var(--wfl-transition)}.wfl-vote-btn:hover{border-color:var(--wfl-primary);color:var(--wfl-primary);background:var(--wfl-primary-light)}.wfl-vote-btn:active{transform:scale(0.92)}.wfl-vote-btn.wfl-voted{background:var(--wfl-primary);border-color:var(--wfl-primary);color:white}.wfl-vote-btn.wfl-voted:hover{background:var(--wfl-primary-hover)}.wfl-vote-btn.wfl-vote-down.wfl-voted{background:var(--wfl-danger);border-color:var(--wfl-danger)}.wfl-vote-btn:disabled{opacity:0.5;cursor:not-allowed}.wfl-vote-count{font-size:18px;font-weight:700;color:var(--wfl-gray-900);min-height:28px;display:flex;align-items:center;transition:var(--wfl-transition)}.wfl-vote-count.wfl-vote-positive{color:var(--wfl-primary)}.wfl-vote-count.wfl-vote-negative{color:var(--wfl-danger)}@keyframes wfl-vote-pop{0%{transform:scale(1)}50%{transform:scale(1.3)}100%{transform:scale(1)}}.wfl-vote-count.wfl-animating{animation:wfl-vote-pop 0.3s ease-out}@keyframes wfl-confetti{0%{transform:translateY(0) rotate(0deg);opacity:1}100%{transform:translateY(-20px) rotate(180deg);opacity:0}}.wfl-confetti{position:absolute;width:6px;height:6px;border-radius:50%;animation:wfl-confetti 0.6s ease-out forwards;pointer-events:none}.wfl-content{flex:1;min-width:0}.wfl-content-header{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;margin-bottom:8px}.wfl-feature-title{font-size:16px;font-weight:600;color:var(--wfl-gray-900);cursor:pointer;transition:var(--wfl-transition)}.wfl-feature-title:hover{color:var(--wfl-primary)}.wfl-status{display:inline-flex;align-items:center;gap:5px;padding:4px 10px;font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:0.5px;border-radius:20px;white-space:nowrap;flex-shrink:0}.wfl-status-dot{width:6px;height:6px;border-radius:50%}.wfl-status-open{background:var(--wfl-primary-light);color:var(--wfl-primary)}.wfl-status-open .wfl-status-dot{background:var(--wfl-primary)}.wfl-status-planned{background:#fef3c7;color:#d97706}.wfl-status-planned .wfl-status-dot{background:var(--wfl-warning)}.wfl-status-progress{background:#d1fae5;color:#059669}.wfl-status-progress .wfl-status-dot{background:var(--wfl-success);animation:wfl-pulse 2s infinite}@keyframes wfl-pulse{0%,100%{opacity:1}50%{opacity:0.5}}.wfl-status-completed{background:#d1fae5;color:#059669}.wfl-status-completed .wfl-status-dot{background:var(--wfl-success)}.wfl-description{font-size:14px;color:var(--wfl-gray-600);line-height:1.6;margin-bottom:12px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.wfl-footer{display:flex;align-items:center;gap:16px}.wfl-meta{display:flex;align-items:center;gap:6px;font-size:13px;color:var(--wfl-gray-500);cursor:pointer;padding:4px 8px;border-radius:6px;transition:var(--wfl-transition);border:1px solid var(--wfl-gray-100)}.wfl-meta:hover{background:var(--wfl-gray-100);color:var(--wfl-gray-700)}.wfl-meta svg{width:14px;height:14px}.wfl-tag{display:inline-flex;align-items:center;padding:3px 8px;font-size:11px;font-weight:500;background:var(--wfl-gray-100);color:var(--wfl-gray-600);border-radius:5px}.wfl-modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.5);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:99999;opacity:0;visibility:hidden;transition:var(--wfl-transition);padding:20px}.wfl-modal-overlay.wfl-active{opacity:1;visibility:visible}.wfl-modal{background:white;border-radius:var(--wfl-radius-lg);width:100%;max-width:520px;max-height:90vh;overflow:hidden;transform:scale(0.9) translateY(20px);transition:var(--wfl-transition);box-shadow:var(--wfl-shadow-xl)}.wfl-modal-overlay.wfl-active .wfl-modal{transform:scale(1) translateY(0)}.wfl-modal-header{display:flex;align-items:center;justify-content:space-between;padding:20px 24px;border-bottom:1px solid var(--wfl-gray-200)}.wfl-modal-title{font-size:18px;font-weight:600;color:var(--wfl-gray-900)}.wfl-modal-close{width:32px;height:32px;border-radius:8px;border:none;background:transparent;cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--wfl-gray-500);transition:var(--wfl-transition)}.wfl-modal-close:hover{background:var(--wfl-gray-100);color:var(--wfl-gray-700)}.wfl-modal-close svg{width:20px;height:20px}.wfl-modal-body{padding:24px;overflow-y:auto;max-height:calc(90vh - 140px)}.wfl-form-group{margin-bottom:20px}.wfl-label{display:block;font-size:14px;font-weight:500;color:var(--wfl-gray-700);margin-bottom:8px}.wfl-input,.wfl-textarea,input.wfl-input{width:100%;padding:12px 14px;font-size:14px;border:1.5px solid var(--wfl-gray-200);border-radius:10px;background:white;color:var(--wfl-gray-800);transition:var(--wfl-transition);font-family:inherit}.wfl-input:focus,.wfl-textarea:focus{outline:none;border-color:var(--wfl-primary);box-shadow:0 0 0 3px rgba(99,102,241,0.1)}.wfl-input::placeholder,.wfl-textarea::placeholder{color:var(--wfl-gray-400)}.wfl-textarea{resize:vertical;min-height:100px}.wfl-modal-footer{display:flex;justify-content:flex-end;gap:12px;padding:16px 24px;border-top:1px solid var(--wfl-gray-200);background:var(--wfl-gray-50)}.wfl-comments-section{margin-top:16px;padding-top:16px;border-top:1px solid var(--wfl-gray-200)}.wfl-comments-list{display:flex;flex-direction:column;gap:12px;margin-bottom:16px}.wfl-comment{display:flex;gap:12px}.wfl-comment-avatar{width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,var(--wfl-primary) 0%,#8b5cf6 100%);display:flex;align-items:center;justify-content:center;color:white;font-size:12px;font-weight:600;flex-shrink:0}.wfl-comment-content{flex:1;background:var(--wfl-gray-50);padding:10px 14px;border-radius:10px}.wfl-comment-header{display:flex;align-items:center;gap:8px;margin-bottom:4px}.wfl-comment-author{font-size:13px;font-weight:600;color:var(--wfl-gray-800)}.wfl-comment-time{font-size:12px;color:var(--wfl-gray-400)}.wfl-comment-text{font-size:14px;color:var(--wfl-gray-600);line-height:1.5}.wfl-comment-input-wrapper{display:flex;gap:12px}.wfl-comment-input{flex:1;padding:10px 14px;font-size:14px;border:1.5px solid var(--wfl-gray-200);border-radius:10px;background:white;color:var(--wfl-gray-800);transition:var(--wfl-transition);font-family:inherit}.wfl-comment-input:focus{outline:none;border-color:var(--wfl-primary);box-shadow:0 0 0 3px rgba(99,102,241,0.1)}.wfl-comment-submit{width:40px;height:40px;border-radius:10px;border:none;background:var(--wfl-primary);color:white;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:var(--wfl-transition)}.wfl-comment-submit:hover{background:var(--wfl-primary-hover);transform:scale(1.05)}.wfl-comment-submit:active{transform:scale(0.95)}.wfl-comment-submit svg{width:18px;height:18px}.wfl-empty{text-align:center;padding:48px 24px}.wfl-empty-icon{width:64px;height:64px;background:var(--wfl-gray-100);border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 16px}.wfl-empty-icon svg{width:28px;height:28px;color:var(--wfl-gray-400)}.wfl-empty-title{font-size:16px;font-weight:600;color:var(--wfl-gray-800);margin-bottom:4px}.wfl-empty-text{font-size:14px;color:var(--wfl-gray-500)}.wfl-toast{position:fixed;bottom:24px;right:24px;padding:14px 20px;background:var(--wfl-gray-900);color:white;font-size:14px;font-weight:500;border-radius:10px;box-shadow:var(--wfl-shadow-lg);z-index:999999;transform:translateY(100px);opacity:0;transition:var(--wfl-transition)}.wfl-toast.wfl-active{transform:translateY(0);opacity:1}.wfl-toast-success{background:var(--wfl-success)}.wfl-toast-error{background:var(--wfl-danger)}.wfl-skeleton{background:linear-gradient(90deg,var(--wfl-gray-200) 25%,var(--wfl-gray-100) 50%,var(--wfl-gray-200) 75%);background-size:200% 100%;animation:wfl-shimmer 1.5s infinite;border-radius:6px}@keyframes wfl-shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}.wfl-skeleton-card{background:white;border-radius:var(--wfl-radius-lg);border:1px solid var(--wfl-gray-200);padding:16px;display:flex;gap:16px;align-items:center}.wfl-skeleton-vote{display:flex;flex-direction:column;align-items:center;gap:8px;min-width:56px}.wfl-skeleton-vote-btn{width:40px;height:32px}.wfl-skeleton-vote-count{width:24px;height:20px}.wfl-skeleton-content{flex:1}.wfl-skeleton-title{height:20px;width:60%;margin-bottom:12px}.wfl-skeleton-desc{height:14px;width:90%;margin-bottom:8px}.wfl-skeleton-desc-2{height:14px;width:70%;margin-bottom:16px}.wfl-skeleton-footer{display:flex;gap:12px}.wfl-skeleton-meta{height:24px;width:80px}.wfl-skeleton-tag{height:20px;width:50px}@media (max-width:600px){.wfl-container{padding:16px}.wfl-header{flex-direction:column;align-items:stretch}.wfl-card{flex-direction:column;align-items:stretch}.wfl-vote{flex-direction:row;justify-content:flex-start}.wfl-modal{max-width:100%;margin:16px}.wfl-skeleton-card{flex-direction:column;align-items:stretch}.wfl-skeleton-vote{flex-direction:row;justify-content:flex-start}}.wfl-ripple{position:relative;overflow:hidden}.wfl-ripple::after{content:\"\";position:absolute;width:100%;height:100%;top:0;left:0;pointer-events:none;background-image:radial-gradient(circle,rgba(255,255,255,0.3) 10%,transparent 10.01%);background-repeat:no-repeat;background-position:50%;transform:scale(10,10);opacity:0;transition:transform 0.5s,opacity 1s}.wfl-ripple:active::after{transform:scale(0,0);opacity:0.3;transition:0s}.wfl-tooltip{position:relative}.wfl-tooltip::after{content:attr(data-tooltip);position:absolute;bottom:100%;left:50%;transform:translateX(-50%) translateY(-4px);padding:6px 10px;background:var(--wfl-gray-900);color:white;font-size:12px;font-weight:500;border-radius:6px;white-space:nowrap;opacity:0;visibility:hidden;transition:var(--wfl-transition);pointer-events:none}.wfl-tooltip:hover::after{opacity:1;visibility:visible;transform:translateX(-50%) translateY(-8px)}.wfl-btn:focus-visible,.wfl-vote-btn:focus-visible,.wfl-input:focus-visible,.wfl-textarea:focus-visible{outline:2px solid var(--wfl-primary);outline-offset:2px}.wfl-error{text-align:center;padding:48px 24px;color:var(--wfl-danger)}.wfl-error-icon{width:64px;height:64px;background:#fef2f2;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 16px}.wfl-error-icon svg{width:28px;height:28px;color:var(--wfl-danger)}.wfl-error-title{font-size:16px;font-weight:600;margin-bottom:4px}.wfl-error-text{font-size:14px;color:var(--wfl-gray-500);margin-bottom:16px}`;\n\n  /**\n   * Inject styles into the document head\n   */\n  function injectStyles() {\n    if (typeof document === \"undefined\") return;\n    if (document.getElementById(\"wpfeatureloop-styles\")) return;\n\n    const styleElement = document.createElement(\"style\");\n    styleElement.id = \"wpfeatureloop-styles\";\n    styleElement.textContent = styles;\n    document.head.appendChild(styleElement);\n  }\n\n  // Auto-inject styles when module loads\n  injectStyles();\n\n  /**\n   * SVG Icons\n   */\n  const icons = {\n    plus: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M12 5v14M5 12h14\"/></svg>',\n    arrowUp:\n      '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m18 15-6-6-6 6\"/></svg>',\n    arrowDown:\n      '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m6 9 6 6 6-6\"/></svg>',\n    comment:\n      '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"/></svg>',\n    close:\n      '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M18 6 6 18M6 6l12 12\"/></svg>',\n    send: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m22 2-7 20-4-9-9-4 20-7z\"/><path d=\"m22 2-11 11\"/></svg>',\n    empty:\n      '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\"/></svg>',\n    error:\n      '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"/><path d=\"m15 9-6 6M9 9l6 6\"/></svg>',\n  };\n\n  /**\n   * Translations\n   */\n  const translations = {\n    en: {\n      title: \"Feature Roadmap\",\n      subtitle: \"Vote for features you want to see next\",\n      suggestFeature: \"Suggest Feature\",\n      suggestTitle: \"Suggest a Feature\",\n      titleLabel: \"Title\",\n      titlePlaceholder: \"Brief description of your feature idea\",\n      descriptionLabel: \"Description\",\n      descriptionPlaceholder:\n        \"Explain the feature and why it would be valuable...\",\n      categoryLabel: \"Category\",\n      categoryPlaceholder: \"e.g., UI/UX, Performance, Integration\",\n      cancel: \"Cancel\",\n      submit: \"Submit Feature\",\n      comments: \"comments\",\n      comment: \"comment\",\n      addComment: \"Add a comment...\",\n      noComments: \"No comments yet. Be the first to share your thoughts!\",\n      emptyTitle: \"No features yet\",\n      emptyText: \"Be the first to suggest a feature!\",\n      errorTitle: \"Failed to load features\",\n      errorText: \"Please try again later.\",\n      retry: \"Retry\",\n      fillAllFields: \"Please fill in all fields\",\n      featureSubmitted: \"Feature submitted successfully!\",\n      commentAdded: \"Comment added!\",\n      voteSaved: \"Vote saved!\",\n      statusOpen: \"Open\",\n      statusPlanned: \"Planned\",\n      statusProgress: \"In Progress\",\n      statusCompleted: \"Completed\",\n      upvote: \"Upvote\",\n      downvote: \"Downvote\",\n    },\n    \"pt-BR\": {\n      title: \"Roadmap de Features\",\n      subtitle: \"Vote nas funcionalidades que deseja ver\",\n      suggestFeature: \"Sugerir Feature\",\n      suggestTitle: \"Sugerir uma Feature\",\n      titleLabel: \"Título\",\n      titlePlaceholder: \"Breve descrição da sua ideia\",\n      descriptionLabel: \"Descrição\",\n      descriptionPlaceholder: \"Explique a feature e por que seria valiosa...\",\n      categoryLabel: \"Categoria\",\n      categoryPlaceholder: \"Ex: UI/UX, Performance, Integração\",\n      cancel: \"Cancelar\",\n      submit: \"Enviar Feature\",\n      comments: \"comentários\",\n      comment: \"comentário\",\n      addComment: \"Adicionar um comentário...\",\n      noComments: \"Nenhum comentário ainda. Seja o primeiro!\",\n      emptyTitle: \"Nenhuma feature ainda\",\n      emptyText: \"Seja o primeiro a sugerir uma feature!\",\n      errorTitle: \"Erro ao carregar features\",\n      errorText: \"Por favor, tente novamente mais tarde.\",\n      retry: \"Tentar novamente\",\n      fillAllFields: \"Por favor, preencha todos os campos\",\n      featureSubmitted: \"Feature enviada com sucesso!\",\n      commentAdded: \"Comentário adicionado!\",\n      voteSaved: \"Voto salvo!\",\n      statusOpen: \"Aberto\",\n      statusPlanned: \"Planejado\",\n      statusProgress: \"Em Progresso\",\n      statusCompleted: \"Concluído\",\n      upvote: \"Votar a favor\",\n      downvote: \"Votar contra\",\n    },\n  };\n\n  /**\n   * API Service\n   * Handles all API communication\n   */\n  class ApiService {\n    constructor(config) {\n      this.publicKey = config.publicKey;\n      this.projectId = config.projectId;\n      this.user = config.user;\n      this.signature = config.signature;\n      this.baseUrl = config.apiUrl || \"https://api.wpfeatureloop.com/api/v1\";\n    }\n\n    /**\n     * Get headers for API requests\n     */\n    _getHeaders() {\n      return {\n        \"Content-Type\": \"application/json\",\n        \"X-Public-Key\": this.publicKey,\n        \"X-Project-Id\": this.projectId,\n        \"X-User-Id\": this.user?.id?.toString() || \"\",\n        \"X-User-Name\": this.user?.name || \"\",\n        \"X-Signature\": this.signature || \"\",\n      };\n    }\n\n    /**\n     * Handle API response\n     */\n    async _handleResponse(response) {\n      if (!response.ok) {\n        const data = await response.json().catch(() => ({}));\n        const error = new Error(data.error || `HTTP error ${response.status}`);\n        error.status = response.status;\n        error.data = data;\n        throw error;\n      }\n      return response.json();\n    }\n\n    /**\n     * Fetch features list\n     * @returns {Promise<Array>}\n     */\n    async getFeatures() {\n      const response = await fetch(`${this.baseUrl}/features`, {\n        method: \"GET\",\n        headers: this._getHeaders(),\n      });\n      return this._handleResponse(response);\n    }\n\n    /**\n     * Vote on a feature\n     * @param {string} featureId\n     * @param {string} voteType - 'up', 'down', or 'none'\n     * @returns {Promise<Object>}\n     */\n    async vote(featureId, voteType) {\n      const response = await fetch(`${this.baseUrl}/features/${featureId}/vote`, {\n        method: \"POST\",\n        headers: this._getHeaders(),\n        body: JSON.stringify({ vote: voteType }),\n      });\n      return this._handleResponse(response);\n    }\n\n    /**\n     * Get comments for a feature\n     * @param {string} featureId\n     * @returns {Promise<Array>}\n     */\n    async getComments(featureId) {\n      const response = await fetch(`${this.baseUrl}/features/${featureId}/comments`, {\n        method: \"GET\",\n        headers: this._getHeaders(),\n      });\n      return this._handleResponse(response);\n    }\n\n    /**\n     * Add a comment to a feature\n     * @param {string} featureId\n     * @param {string} text\n     * @returns {Promise<Object>}\n     */\n    async addComment(featureId, text) {\n      const response = await fetch(`${this.baseUrl}/features/${featureId}/comments`, {\n        method: \"POST\",\n        headers: this._getHeaders(),\n        body: JSON.stringify({ text }),\n      });\n      return this._handleResponse(response);\n    }\n\n    /**\n     * Create a new feature suggestion\n     * @param {Object} feature\n     * @returns {Promise<Object>}\n     */\n    async createFeature(feature) {\n      const response = await fetch(`${this.baseUrl}/features`, {\n        method: \"POST\",\n        headers: this._getHeaders(),\n        body: JSON.stringify({\n          title: feature.title,\n          description: feature.description,\n        }),\n      });\n      return this._handleResponse(response);\n    }\n  }\n\n  /**\n   * WPFeatureLoop Main Class\n   */\n  class WPFeatureLoop {\n    /**\n     * @param {Object} config\n     * @param {string} config.container - CSS selector for the container element\n     * @param {string} config.publicKey - Public API key\n     * @param {string} config.projectId - Project ID\n     * @param {string} [config.locale='en'] - Locale for translations\n     * @param {Object} [config.user] - User data\n     * @param {number|string} config.user.id - User ID (required)\n     * @param {string} [config.user.email] - User email\n     * @param {string} [config.user.name] - User display name\n     * @param {string} [config.user.plan] - User plan (free, pro, etc)\n     * @param {Object} [config.user.meta] - Additional user metadata\n     * @param {string} [config.signature] - HMAC signature for user data\n     * @param {Array<string>} [config.allowedRoles] - Roles allowed to create features\n     * @param {string} [config.userRole] - Current user's role\n     * @param {string} [config.apiUrl] - Custom API URL\n     */\n    constructor(config) {\n      this.config = config;\n      this.container = null;\n      this.features = [];\n      this.isLoading = true;\n      this.hasError = false;\n      this.currentCommentFeatureId = null;\n      this.currentComments = [];\n\n      // Validate required config\n      if (!config.container) {\n        throw new Error(\"WPFeatureLoop: container is required\");\n      }\n      if (!config.publicKey) {\n        throw new Error(\"WPFeatureLoop: publicKey is required\");\n      }\n      if (!config.projectId) {\n        throw new Error(\"WPFeatureLoop: projectId is required\");\n      }\n      if (!config.user?.id) {\n        throw new Error(\"WPFeatureLoop: user.id is required\");\n      }\n\n      // Set defaults\n      this.locale = config.locale || \"en\";\n      this.t = translations[this.locale] || translations[\"en\"];\n      this.allowedRoles = config.allowedRoles || [\"administrator\"];\n      this.userRole = config.userRole || \"subscriber\";\n\n      // Initialize API service\n      this.api = new ApiService(config);\n    }\n\n    /**\n     * Check if current user can create features\n     */\n    canCreateFeature() {\n      return this.allowedRoles.includes(this.userRole);\n    }\n\n    /**\n     * Initialize the widget\n     */\n    async init() {\n      this.container = document.querySelector(this.config.container);\n\n      if (!this.container) {\n        throw new Error(\n          `WPFeatureLoop: Container \"${this.config.container}\" not found`,\n        );\n      }\n\n      this.container.classList.add(\"wfl-container\");\n      this.renderSkeleton();\n\n      try {\n        this.features = await this.api.getFeatures();\n        this.isLoading = false;\n        this.render();\n      } catch (error) {\n        console.error(\"WPFeatureLoop: Failed to load features\", error);\n        this.isLoading = false;\n        this.hasError = true;\n        this.renderError();\n      }\n    }\n\n    /**\n     * Render skeleton loading state\n     */\n    renderSkeleton() {\n      const skeletonCards = Array(3)\n        .fill(0)\n        .map(\n          () => `\n        <div class=\"wfl-skeleton-card\">\n          <div class=\"wfl-skeleton-vote\">\n            <div class=\"wfl-skeleton wfl-skeleton-vote-btn\"></div>\n            <div class=\"wfl-skeleton wfl-skeleton-vote-count\"></div>\n            <div class=\"wfl-skeleton wfl-skeleton-vote-btn\"></div>\n          </div>\n          <div class=\"wfl-skeleton-content\">\n            <div class=\"wfl-skeleton wfl-skeleton-title\"></div>\n            <div class=\"wfl-skeleton wfl-skeleton-desc\"></div>\n            <div class=\"wfl-skeleton wfl-skeleton-desc-2\"></div>\n            <div class=\"wfl-skeleton-footer\">\n              <div class=\"wfl-skeleton wfl-skeleton-meta\"></div>\n              <div class=\"wfl-skeleton wfl-skeleton-tag\"></div>\n            </div>\n          </div>\n        </div>\n      `,\n        )\n        .join(\"\");\n\n      this.container.innerHTML = `\n        <div class=\"wfl-header\">\n          <div class=\"wfl-header-content\">\n            <h1 class=\"wfl-title\">${this.t.title}</h1>\n            <p class=\"wfl-subtitle\">${this.t.subtitle}</p>\n          </div>\n          ${\n            this.canCreateFeature()\n              ? `\n            <button class=\"wfl-btn wfl-btn-primary wfl-ripple\" disabled>\n              ${icons.plus}\n              ${this.t.suggestFeature}\n            </button>\n          `\n              : \"\"\n          }\n        </div>\n        <div class=\"wfl-list\">\n          ${skeletonCards}\n        </div>\n      `;\n    }\n\n    /**\n     * Render error state\n     */\n    renderError() {\n      this.container.innerHTML = `\n        <div class=\"wfl-header\">\n          <div class=\"wfl-header-content\">\n            <h1 class=\"wfl-title\">${this.t.title}</h1>\n            <p class=\"wfl-subtitle\">${this.t.subtitle}</p>\n          </div>\n        </div>\n        <div class=\"wfl-error\">\n          <div class=\"wfl-error-icon\">${icons.error}</div>\n          <h3 class=\"wfl-error-title\">${this.t.errorTitle}</h3>\n          <p class=\"wfl-error-text\">${this.t.errorText}</p>\n          <button class=\"wfl-btn wfl-btn-primary\" id=\"wfl-retry\">\n            ${this.t.retry}\n          </button>\n        </div>\n      `;\n\n      this.container\n        .querySelector(\"#wfl-retry\")\n        ?.addEventListener(\"click\", () => {\n          this.hasError = false;\n          this.isLoading = true;\n          this.init();\n        });\n    }\n\n    /**\n     * Main render method\n     */\n    render() {\n      const featuresHtml =\n        this.features.length > 0\n          ? this.features.map((f) => this.renderCard(f)).join(\"\")\n          : this.renderEmpty();\n\n      this.container.innerHTML = `\n        <div class=\"wfl-header\">\n          <div class=\"wfl-header-content\">\n            <h1 class=\"wfl-title\">${this.t.title}</h1>\n            <p class=\"wfl-subtitle\">${this.t.subtitle}</p>\n          </div>\n          ${\n            this.canCreateFeature()\n              ? `\n            <button class=\"wfl-btn wfl-btn-primary wfl-ripple\" id=\"wfl-add-feature\">\n              ${icons.plus}\n              ${this.t.suggestFeature}\n            </button>\n          `\n              : \"\"\n          }\n        </div>\n        <div class=\"wfl-list\" id=\"wfl-list\">\n          ${featuresHtml}\n        </div>\n        ${this.renderModal()}\n        ${this.renderCommentModal()}\n        <div class=\"wfl-toast\" id=\"wfl-toast\"></div>\n      `;\n\n      this.attachEventListeners();\n    }\n\n    /**\n     * Render a feature card\n     */\n    renderCard(feature) {\n      const voteClass =\n        feature.votes > 0\n          ? \"wfl-vote-positive\"\n          : feature.votes < 0\n            ? \"wfl-vote-negative\"\n            : \"\";\n      const upVoted = feature.userVote === \"up\";\n      const downVoted = feature.userVote === \"down\";\n      const commentText =\n        feature.commentsCount === 1 ? this.t.comment : this.t.comments;\n\n      return `\n        <div class=\"wfl-card\" data-id=\"${feature.id}\">\n          <div class=\"wfl-vote\">\n            <button class=\"wfl-vote-btn wfl-vote-up wfl-tooltip ${upVoted ? \"wfl-voted\" : \"\"}\"\n                    data-id=\"${feature.id}\"\n                    data-action=\"up\"\n                    data-tooltip=\"${this.t.upvote}\">\n              ${icons.arrowUp}\n            </button>\n            <span class=\"wfl-vote-count ${voteClass}\" data-id=\"${feature.id}\">${feature.votes}</span>\n            <button class=\"wfl-vote-btn wfl-vote-down wfl-tooltip ${downVoted ? \"wfl-voted\" : \"\"}\"\n                    data-id=\"${feature.id}\"\n                    data-action=\"down\"\n                    data-tooltip=\"${this.t.downvote}\">\n              ${icons.arrowDown}\n            </button>\n          </div>\n          <div class=\"wfl-content\">\n            <div class=\"wfl-content-header\">\n              <h3 class=\"wfl-feature-title\" data-id=\"${feature.id}\">${feature.title}</h3>\n              ${this.renderStatus(feature.status)}\n            </div>\n            <p class=\"wfl-description\">${feature.description}</p>\n            <div class=\"wfl-footer\">\n              <button class=\"wfl-meta wfl-comment-trigger\" data-id=\"${feature.id}\">\n                ${icons.comment}\n                <span>${feature.commentsCount} ${commentText}</span>\n              </button>\n              ${(feature.tags || []).map((tag) => `<span class=\"wfl-tag\">${tag}</span>`).join(\"\")}\n            </div>\n          </div>\n        </div>\n      `;\n    }\n\n    /**\n     * Render status badge\n     */\n    renderStatus(status) {\n      const labels = {\n        open: this.t.statusOpen,\n        planned: this.t.statusPlanned,\n        progress: this.t.statusProgress,\n        completed: this.t.statusCompleted,\n      };\n\n      return `\n        <span class=\"wfl-status wfl-status-${status}\">\n          <span class=\"wfl-status-dot\"></span>\n          ${labels[status] || status}\n        </span>\n      `;\n    }\n\n    /**\n     * Render empty state\n     */\n    renderEmpty() {\n      return `\n        <div class=\"wfl-empty\">\n          <div class=\"wfl-empty-icon\">${icons.empty}</div>\n          <h3 class=\"wfl-empty-title\">${this.t.emptyTitle}</h3>\n          <p class=\"wfl-empty-text\">${this.t.emptyText}</p>\n        </div>\n      `;\n    }\n\n    /**\n     * Render feature creation modal\n     */\n    renderModal() {\n      if (!this.canCreateFeature()) return \"\";\n\n      return `\n        <div class=\"wfl-modal-overlay\" id=\"wfl-modal\">\n          <div class=\"wfl-modal\">\n            <div class=\"wfl-modal-header\">\n              <h2 class=\"wfl-modal-title\">${this.t.suggestTitle}</h2>\n              <button class=\"wfl-modal-close\" id=\"wfl-modal-close\">\n                ${icons.close}\n              </button>\n            </div>\n            <div class=\"wfl-modal-body\">\n              <div class=\"wfl-form-group\">\n                <label class=\"wfl-label\" for=\"wfl-feature-title\">${this.t.titleLabel}</label>\n                <input type=\"text\" class=\"wfl-input\" id=\"wfl-feature-title\" placeholder=\"${this.t.titlePlaceholder}\">\n              </div>\n              <div class=\"wfl-form-group\">\n                <label class=\"wfl-label\" for=\"wfl-feature-desc\">${this.t.descriptionLabel}</label>\n                <textarea class=\"wfl-textarea\" id=\"wfl-feature-desc\" placeholder=\"${this.t.descriptionPlaceholder}\"></textarea>\n              </div>\n              <div class=\"wfl-form-group\">\n                <label class=\"wfl-label\" for=\"wfl-feature-tag\">${this.t.categoryLabel}</label>\n                <input type=\"text\" class=\"wfl-input\" id=\"wfl-feature-tag\" placeholder=\"${this.t.categoryPlaceholder}\">\n              </div>\n            </div>\n            <div class=\"wfl-modal-footer\">\n              <button class=\"wfl-btn wfl-btn-secondary\" id=\"wfl-modal-cancel\">${this.t.cancel}</button>\n              <button class=\"wfl-btn wfl-btn-primary wfl-ripple\" id=\"wfl-modal-submit\">${this.t.submit}</button>\n            </div>\n          </div>\n        </div>\n      `;\n    }\n\n    /**\n     * Render comments modal\n     */\n    renderCommentModal() {\n      return `\n        <div class=\"wfl-modal-overlay\" id=\"wfl-comment-modal\">\n          <div class=\"wfl-modal\">\n            <div class=\"wfl-modal-header\">\n              <h2 class=\"wfl-modal-title\" id=\"wfl-comment-title\">${this.t.comments}</h2>\n              <button class=\"wfl-modal-close\" id=\"wfl-comment-modal-close\">\n                ${icons.close}\n              </button>\n            </div>\n            <div class=\"wfl-modal-body\">\n              <div class=\"wfl-comments-list\" id=\"wfl-comments-list\"></div>\n              <div class=\"wfl-comment-input-wrapper\">\n                <input type=\"text\" class=\"wfl-comment-input\" id=\"wfl-comment-input\" placeholder=\"${this.t.addComment}\">\n                <button class=\"wfl-comment-submit\" id=\"wfl-comment-submit\">\n                  ${icons.send}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      `;\n    }\n\n    /**\n     * Render comments list\n     */\n    renderCommentsList(comments) {\n      if (comments.length === 0) {\n        return `<p style=\"text-align: center; color: var(--wfl-gray-500); padding: 20px;\">${this.t.noComments}</p>`;\n      }\n\n      return comments\n        .map(\n          (c) => `\n        <div class=\"wfl-comment\">\n          <div class=\"wfl-comment-avatar\">${c.initials}</div>\n          <div class=\"wfl-comment-content\">\n            <div class=\"wfl-comment-header\">\n              <span class=\"wfl-comment-author\">${c.author}</span>\n              <span class=\"wfl-comment-time\">${c.time}</span>\n            </div>\n            <p class=\"wfl-comment-text\">${c.text}</p>\n          </div>\n        </div>\n      `,\n        )\n        .join(\"\");\n    }\n\n    /**\n     * Attach event listeners\n     */\n    attachEventListeners() {\n      // Add feature button\n      const addBtn = this.container.querySelector(\"#wfl-add-feature\");\n      if (addBtn) {\n        addBtn.addEventListener(\"click\", () => this.openModal());\n      }\n\n      // Modal events\n      const modal = this.container.querySelector(\"#wfl-modal\");\n      if (modal) {\n        const modalClose = this.container.querySelector(\"#wfl-modal-close\");\n        const modalCancel = this.container.querySelector(\"#wfl-modal-cancel\");\n        const modalSubmit = this.container.querySelector(\"#wfl-modal-submit\");\n\n        modalClose?.addEventListener(\"click\", () => this.closeModal());\n        modalCancel?.addEventListener(\"click\", () => this.closeModal());\n        modal.addEventListener(\"click\", (e) => {\n          if (e.target === modal) this.closeModal();\n        });\n        modalSubmit?.addEventListener(\"click\", () =>\n          this.handleSubmitFeature(),\n        );\n      }\n\n      // Comment modal events\n      const commentModal = this.container.querySelector(\"#wfl-comment-modal\");\n      if (commentModal) {\n        const commentClose = this.container.querySelector(\n          \"#wfl-comment-modal-close\",\n        );\n\n        commentClose?.addEventListener(\"click\", () => this.closeCommentModal());\n        commentModal.addEventListener(\"click\", (e) => {\n          if (e.target === commentModal) this.closeCommentModal();\n        });\n      }\n\n      // Card events\n      this.features.forEach((f) => this.attachCardListeners(f.id));\n    }\n\n    /**\n     * Attach listeners to a specific card\n     */\n    attachCardListeners(featureId) {\n      const card = this.container.querySelector(\n        `.wfl-card[data-id=\"${featureId}\"]`,\n      );\n      if (!card) return;\n\n      // Vote buttons\n      card.querySelectorAll(\".wfl-vote-btn\").forEach((btn) => {\n        btn.addEventListener(\"click\", (e) => {\n          e.stopPropagation();\n          this.handleVote(btn);\n        });\n      });\n\n      // Comment trigger\n      const commentTrigger = card.querySelector(\".wfl-comment-trigger\");\n      if (commentTrigger) {\n        commentTrigger.addEventListener(\"click\", () => {\n          this.openCommentModal(featureId);\n        });\n      }\n    }\n\n    /**\n     * Open feature creation modal\n     */\n    openModal() {\n      const modal = this.container.querySelector(\"#wfl-modal\");\n      if (modal) {\n        modal.classList.add(\"wfl-active\");\n      }\n    }\n\n    /**\n     * Close feature creation modal\n     */\n    closeModal() {\n      const modal = this.container.querySelector(\"#wfl-modal\");\n      if (modal) {\n        modal.classList.remove(\"wfl-active\");\n        this.container.querySelector(\"#wfl-feature-title\").value = \"\";\n        this.container.querySelector(\"#wfl-feature-desc\").value = \"\";\n        this.container.querySelector(\"#wfl-feature-tag\").value = \"\";\n      }\n    }\n\n    /**\n     * Handle feature submission\n     */\n    async handleSubmitFeature() {\n      const title = this.container\n        .querySelector(\"#wfl-feature-title\")\n        .value.trim();\n      const description = this.container\n        .querySelector(\"#wfl-feature-desc\")\n        .value.trim();\n      const category =\n        this.container.querySelector(\"#wfl-feature-tag\").value.trim() ||\n        \"General\";\n\n      if (!title || !description) {\n        this.showToast(this.t.fillAllFields, \"error\");\n        return;\n      }\n\n      const submitBtn = this.container.querySelector(\"#wfl-modal-submit\");\n      submitBtn.disabled = true;\n\n      try {\n        const newFeature = await this.api.createFeature({\n          title,\n          description,\n          category,\n        });\n        this.features.unshift(newFeature);\n\n        const list = this.container.querySelector(\"#wfl-list\");\n        list.insertAdjacentHTML(\"afterbegin\", this.renderCard(newFeature));\n        this.attachCardListeners(newFeature.id);\n\n        this.closeModal();\n        this.showToast(this.t.featureSubmitted, \"success\");\n      } catch (error) {\n        console.error(\"WPFeatureLoop: Failed to create feature\", error);\n        this.showToast(this.t.errorText, \"error\");\n      } finally {\n        submitBtn.disabled = false;\n      }\n    }\n\n    /**\n     * Open comments modal\n     */\n    async openCommentModal(featureId) {\n      const feature = this.features.find((f) => f.id === featureId);\n      if (!feature) return;\n\n      this.currentCommentFeatureId = featureId;\n      const commentModal = this.container.querySelector(\"#wfl-comment-modal\");\n      const commentsList = this.container.querySelector(\"#wfl-comments-list\");\n      const commentTitle = this.container.querySelector(\"#wfl-comment-title\");\n      const commentInput = this.container.querySelector(\"#wfl-comment-input\");\n\n      // Clear input and show modal\n      commentInput.value = \"\";\n      commentTitle.textContent = feature.title;\n      commentsList.innerHTML =\n        '<div class=\"wfl-skeleton\" style=\"height: 60px; margin-bottom: 12px;\"></div>'.repeat(\n          2,\n        );\n      commentModal.classList.add(\"wfl-active\");\n\n      try {\n        this.currentComments = await this.api.getComments(featureId);\n        commentsList.innerHTML = this.renderCommentsList(this.currentComments);\n\n        // Create submit handler that reads input value at call time\n        const self = this;\n        const handleSubmit = async () => {\n          // Get fresh reference to input element\n          const input = self.container.querySelector(\"#wfl-comment-input\");\n          const submitBtn = self.container.querySelector(\"#wfl-comment-submit\");\n          const text = input.value.trim();\n\n          if (!text) return;\n\n          submitBtn.disabled = true;\n\n          try {\n            const newComment = await self.api.addComment(featureId, text);\n            self.currentComments.push(newComment);\n            commentsList.innerHTML = self.renderCommentsList(\n              self.currentComments,\n            );\n\n            // Update comment count on card\n            feature.commentsCount = self.currentComments.length;\n            const card = self.container.querySelector(\n              `.wfl-card[data-id=\"${featureId}\"]`,\n            );\n            const commentTrigger = card?.querySelector(\n              \".wfl-comment-trigger span\",\n            );\n            if (commentTrigger) {\n              const commentText =\n                feature.commentsCount === 1 ? self.t.comment : self.t.comments;\n              commentTrigger.textContent = `${feature.commentsCount} ${commentText}`;\n            }\n\n            input.value = \"\";\n            self.showToast(self.t.commentAdded, \"success\");\n          } catch (error) {\n            console.error(\"WPFeatureLoop: Failed to add comment\", error);\n            self.showToast(self.t.errorText, \"error\");\n          } finally {\n            submitBtn.disabled = false;\n          }\n        };\n\n        // Attach listeners (replace elements to remove old listeners)\n        const oldSubmit = this.container.querySelector(\"#wfl-comment-submit\");\n        const oldInput = this.container.querySelector(\"#wfl-comment-input\");\n\n        const newSubmit = oldSubmit.cloneNode(true);\n        oldSubmit.parentNode.replaceChild(newSubmit, oldSubmit);\n        newSubmit.addEventListener(\"click\", handleSubmit);\n\n        const newInput = oldInput.cloneNode(true);\n        oldInput.parentNode.replaceChild(newInput, oldInput);\n        newInput.addEventListener(\"keypress\", (e) => {\n          if (e.key === \"Enter\") handleSubmit();\n        });\n      } catch (error) {\n        console.error(\"WPFeatureLoop: Failed to load comments\", error);\n        commentsList.innerHTML = `<p style=\"text-align: center; color: var(--wfl-danger);\">${this.t.errorText}</p>`;\n      }\n    }\n\n    /**\n     * Close comments modal\n     */\n    closeCommentModal() {\n      const commentModal = this.container.querySelector(\"#wfl-comment-modal\");\n      if (commentModal) {\n        commentModal.classList.remove(\"wfl-active\");\n\n        // Clear input\n        const commentInput = this.container.querySelector(\"#wfl-comment-input\");\n        if (commentInput) {\n          commentInput.value = \"\";\n        }\n\n        this.currentCommentFeatureId = null;\n        this.currentComments = [];\n      }\n    }\n\n    /**\n     * Handle vote\n     */\n    async handleVote(btn) {\n      const id = btn.dataset.id;\n      const action = btn.dataset.action;\n      const feature = this.features.find((f) => String(f.id) === String(id));\n\n      if (!feature) return;\n\n      const card = this.container.querySelector(`.wfl-card[data-id=\"${id}\"]`);\n      const voteCount = card.querySelector(\".wfl-vote-count\");\n      const upBtn = card.querySelector(\".wfl-vote-up\");\n      const downBtn = card.querySelector(\".wfl-vote-down\");\n\n      // Disable buttons during request\n      upBtn.disabled = true;\n      downBtn.disabled = true;\n\n      // Store original values for rollback\n      const originalVotes = feature.votes;\n      const originalUserVote = feature.userVote;\n\n      // Calculate new vote state\n      let newVoteType = \"none\";\n      let voteDelta = 0;\n\n      if (action === \"up\") {\n        if (feature.userVote === \"up\") {\n          voteDelta = -1;\n          newVoteType = \"none\";\n        } else if (feature.userVote === \"down\") {\n          voteDelta = 2;\n          newVoteType = \"up\";\n        } else {\n          voteDelta = 1;\n          newVoteType = \"up\";\n        }\n      } else {\n        if (feature.userVote === \"down\") {\n          voteDelta = 1;\n          newVoteType = \"none\";\n        } else if (feature.userVote === \"up\") {\n          voteDelta = -2;\n          newVoteType = \"down\";\n        } else {\n          voteDelta = -1;\n          newVoteType = \"down\";\n        }\n      }\n\n      // Optimistic update\n      feature.votes += voteDelta;\n      feature.userVote = newVoteType === \"none\" ? null : newVoteType;\n\n      // Update UI\n      upBtn.classList.toggle(\"wfl-voted\", feature.userVote === \"up\");\n      downBtn.classList.toggle(\"wfl-voted\", feature.userVote === \"down\");\n      voteCount.textContent = feature.votes;\n      voteCount.classList.remove(\"wfl-vote-positive\", \"wfl-vote-negative\");\n      if (feature.votes > 0) {\n        voteCount.classList.add(\"wfl-vote-positive\");\n      } else if (feature.votes < 0) {\n        voteCount.classList.add(\"wfl-vote-negative\");\n      }\n\n      // Animation\n      voteCount.classList.add(\"wfl-animating\");\n      setTimeout(() => voteCount.classList.remove(\"wfl-animating\"), 300);\n\n      // Confetti on upvote\n      if (action === \"up\" && newVoteType === \"up\") {\n        this.createConfetti(upBtn);\n      }\n\n      try {\n        const result = await this.api.vote(id, newVoteType);\n\n        // Sync with server response\n        feature.votes = result.totalVotes;\n        feature.userVote = result.vote;\n        voteCount.textContent = feature.votes;\n        voteCount.classList.remove(\"wfl-vote-positive\", \"wfl-vote-negative\");\n        if (feature.votes > 0) {\n          voteCount.classList.add(\"wfl-vote-positive\");\n        } else if (feature.votes < 0) {\n          voteCount.classList.add(\"wfl-vote-negative\");\n        }\n      } catch (error) {\n        console.error(\"WPFeatureLoop: Failed to save vote\", error);\n        // Revert to original values\n        feature.votes = originalVotes;\n        feature.userVote = originalUserVote;\n\n        upBtn.classList.toggle(\"wfl-voted\", feature.userVote === \"up\");\n        downBtn.classList.toggle(\"wfl-voted\", feature.userVote === \"down\");\n        voteCount.textContent = feature.votes;\n        voteCount.classList.remove(\"wfl-vote-positive\", \"wfl-vote-negative\");\n        if (feature.votes > 0) {\n          voteCount.classList.add(\"wfl-vote-positive\");\n        } else if (feature.votes < 0) {\n          voteCount.classList.add(\"wfl-vote-negative\");\n        }\n\n        this.showToast(this.t.errorText, \"error\");\n      } finally {\n        upBtn.disabled = false;\n        downBtn.disabled = false;\n      }\n    }\n\n    /**\n     * Create confetti animation\n     */\n    createConfetti(element) {\n      const colors = [\"#6366f1\", \"#8b5cf6\", \"#ec4899\", \"#10b981\", \"#f59e0b\"];\n      const rect = element.getBoundingClientRect();\n\n      for (let i = 0; i < 6; i++) {\n        const confetti = document.createElement(\"div\");\n        confetti.className = \"wfl-confetti\";\n        confetti.style.left = `${rect.left + rect.width / 2 + (Math.random() - 0.5) * 30}px`;\n        confetti.style.top = `${rect.top + rect.height / 2}px`;\n        confetti.style.background =\n          colors[Math.floor(Math.random() * colors.length)];\n        confetti.style.position = \"fixed\";\n        document.body.appendChild(confetti);\n\n        setTimeout(() => confetti.remove(), 600);\n      }\n    }\n\n    /**\n     * Show toast notification\n     */\n    showToast(message, type = \"default\") {\n      const toast = this.container.querySelector(\"#wfl-toast\");\n      if (!toast) return;\n\n      toast.textContent = message;\n      toast.className = \"wfl-toast wfl-active\";\n\n      if (type === \"success\") {\n        toast.classList.add(\"wfl-toast-success\");\n      } else if (type === \"error\") {\n        toast.classList.add(\"wfl-toast-error\");\n      }\n\n      setTimeout(() => {\n        toast.classList.remove(\"wfl-active\");\n      }, 3000);\n    }\n\n    /**\n     * Get all features\n     */\n    getFeatures() {\n      return [...this.features];\n    }\n\n    /**\n     * Refresh features from API\n     */\n    async refresh() {\n      this.isLoading = true;\n      this.renderSkeleton();\n\n      try {\n        this.features = await this.api.getFeatures();\n        this.isLoading = false;\n        this.hasError = false;\n        this.render();\n      } catch (error) {\n        console.error(\"WPFeatureLoop: Failed to refresh features\", error);\n        this.isLoading = false;\n        this.hasError = true;\n        this.renderError();\n      }\n    }\n\n    /**\n     * Destroy the widget\n     */\n    destroy() {\n      if (this.container) {\n        this.container.innerHTML = \"\";\n        this.container.classList.remove(\"wfl-container\");\n      }\n    }\n  }\n\n  /**\n   * Static init method for convenience\n   */\n  WPFeatureLoop.init = function (config) {\n    const instance = new WPFeatureLoop(config);\n    instance.init();\n    return instance;\n  };\n\n  /**\n   * Version\n   */\n  WPFeatureLoop.version = \"1.1.0\";\n\n  return WPFeatureLoop;\n});\n"],"names":["global","factory","this","styles","injectStyles","styleElement","icons","translations","ApiService","config","_b","_a","_c","response","data","error","featureId","voteType","text","feature","WPFeatureLoop","skeletonCards","featuresHtml","f","voteClass","upVoted","downVoted","commentText","tag","status","labels","comments","c","addBtn","modal","modalClose","modalCancel","modalSubmit","e","commentModal","commentClose","card","btn","commentTrigger","title","description","category","submitBtn","newFeature","commentsList","commentTitle","commentInput","self","handleSubmit","input","newComment","oldSubmit","oldInput","newSubmit","newInput","id","action","voteCount","upBtn","downBtn","originalVotes","originalUserVote","newVoteType","voteDelta","result","element","colors","rect","i","confetti","message","type","toast","instance"],"mappings":"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"}